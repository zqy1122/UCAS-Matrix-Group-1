% 定义画圈命令，用于标记主元
\newcommand{\circlednum}[1]{%
    \tikz[baseline=(char.base)]{%
        \node[draw, circle, inner sep=1pt] (char) {#1};%
    }%
}

\section*{2.5 非齐次系统}
回忆一下，一个包含 \(m\) 个线性方程和 \(n\) 个未知数的系统
\[
a_{11}x_{1} + a_{12}x_{2} + \cdots + a_{1n}x_{n} = b_{1}, \quad
a_{21}x_{1} + a_{22}x_{2} + \cdots + a_{2n}x_{n} = b_{2}, \quad \ldots, \quad
a_{m1}x_{1} + a_{m2}x_{2} + \cdots + a_{mn}x_{n} = b_{m}
\]
当至少有一个 \(b_{i} \neq 0\) 时，被称为非齐次系统。与齐次系统不同，非齐次系统可能是不一致的，因此必须应用 §2.3 的技术来判断解是否存在。除非特别说明，本节假设所有系统都是一致的。

为了描述一致非齐次系统的所有可能解，采用与齐次系统相同的方法构造通解：
- 使用高斯消元法将增广矩阵 \([A \mid b]\) 化简为行阶梯形式 \([E \mid c]\)。
- 识别基本变量和自由变量，方法如 §2.4 所述。
- 对 \([E \mid c]\) 应用回代法，将基本变量用自由变量表示。
- 将结果写成形式
  \[
  x = p + x_{f_{1}} h_{1} + x_{f_{2}} h_{2} + \cdots + x_{f_{n-r}} h_{n-r},
  \]
  其中 \(x_{f_{1}}, x_{f_{2}}, \ldots, x_{f_{n-r}}\) 是自由变量，而 \(p, h_{1}, h_{2}, \ldots, h_{n-r}\) 是 \(n \times 1\) 列向量。这就是非齐次系统的通解。

当自由变量 \(x_{f_{i}}\) 取所有可能值时，通解 (2.5.1) 生成系统 \([A \mid b]\) 的所有可能解。与齐次情况类似，列 \(h_{i}\) 和 \(p\) 不依赖于所使用的行阶梯形式 \([E \mid c]\)。因此，可以通过高斯-约当法将 \([A \mid b]\) 完全化简为 \(E_{[A \mid b]}\)，从而避免回代过程。在方便时，我们将采用这种方法。

非齐次系统通解与齐次系统通解的区别在于 (2.5.1) 中出现的列 \(p\)。为了理解 \(p\) 的出现和来源，考虑非齐次系统
\[
\begin{cases}
x_{1} + 2x_{2} + x_{3} + 3x_{4} + 3x_{5} = 4, \\
2x_{1} + 4x_{2} + 4x_{4} + 4x_{5} = 5, \\
x_{1} + 2x_{2} + 3x_{3} + 5x_{4} + 5x_{5} = 7, \\
2x_{1} + 4x_{2} + 4x_{4} + 7x_{5} = 9
\end{cases}
\]
其中系数矩阵与齐次系统 (2.4.1) 相同。如果通过高斯-约当法将 \([A \mid b]\) 完全化简为 \(E_{[A \mid b]}\)：
\[
\begin{pmatrix}
1 & 2 & 1 & 3 & 3 & 4 \\
2 & 4 & 0 & 4 & 4 & 5 \\
1 & 2 & 3 & 5 & 5 & 7 \\
2 & 4 & 0 & 4 & 7 & 9
\end{pmatrix}
\rightarrow
\begin{pmatrix}
1 & 2 & 0 & 2 & 0 & 2 \\
0 & 0 & 1 & 1 & 0 & 1 \\
0 & 0 & 0 & 0 & 1 & 1 \\
0 & 0 & 0 & 0 & 0 & 0
\end{pmatrix}
\]
则得到简化系统：
\[
\begin{cases}
x_{1} + 2x_{2} + 2x_{4} = 2, \\
x_{3} + x_{4} = 1, \\
x_{5} = 1
\end{cases}
\]
求解基本变量 \(x_{1}\), \(x_{3}\), 和 \(x_{5}\) 用自由变量 \(x_{2}\) 和 \(x_{4}\) 表示：
\[
x_{5} = 1, \quad x_{3} = 1 - x_{4}, \quad x_{1} = 2 - 2x_{2} - 2x_{4}
\]
通解通过将这些语句写成形式：
\[
x = \begin{pmatrix} x_{1} \\ x_{2} \\ x_{3} \\ x_{4} \\ x_{5} \end{pmatrix} =
\begin{pmatrix} 2 \\ 0 \\ 1 \\ 0 \\ 1 \end{pmatrix} +
x_{2} \begin{pmatrix} -2 \\ 1 \\ 0 \\ 0 \\ 0 \end{pmatrix} +
x_{4} \begin{pmatrix} -2 \\ 0 \\ -1 \\ 1 \\ 0 \end{pmatrix}
\]
当自由变量 \(x_{2}\) 和 \(x_{4}\) 取所有可能值时，这生成非齐次系统 (2.5.2) 的所有可能解。注意 (2.5.3) 中的列 \(\begin{pmatrix} 2 \\ 0 \\ 1 \\ 0 \\ 1 \end{pmatrix}\) 是非齐次系统的一个特解——当自由变量取 \(x_{2}=0\) 和 \(x_{4}=0\) 时产生的解。

此外，回忆 (2.4.4) 中关联齐次系统
\[
\begin{cases}
x_{1} + 2x_{2} + x_{3} + 3x_{4} + 3x_{5} = 0, \\
2x_{1} + 4x_{2} + 4x_{4} + 4x_{5} = 0, \\
x_{1} + 2x_{2} + 3x_{3} + 5x_{4} + 5x_{5} = 0, \\
2x_{1} + 4x_{2} + 4x_{4} + 7x_{5} = 0
\end{cases}
\]
的通解为：
\[
x = x_{2} \begin{pmatrix} -2 \\ 1 \\ 0 \\ 0 \\ 0 \end{pmatrix} +
x_{4} \begin{pmatrix} -2 \\ 0 \\ -1 \\ 1 \\ 0 \end{pmatrix}
\]
即，关联齐次系统的通解是原始非齐次系统通解的一部分。

这些观察可以组合为：非齐次系统的通解由特解加上关联齐次系统的通解给出。\footnote{对于学习过微分方程的学生，这一陈述应该很熟悉。线性微分方程的通解也有完全相同的情况。这并非偶然——是由于两者问题中固有的线性性质。本文后续将更多讨论这一问题。}

为了说明这一陈述总是成立，假设 \([A \mid b]\) 表示一个一般的 \(m \times n\) 一致系统，其中 \(\operatorname{rank}(A) = r\)。一致性保证 \(b\) 是 \([A \mid b]\) 中的非基本列，因此 \([A \mid b]\) 中的基本列与 \([A \mid 0]\) 中的基本列位置相同，从而非齐次系统和关联齐次系统具有完全相同的基本变量和自由变量集合。此外，不难看出
\[
E_{[A \mid b]} = \begin{pmatrix} 1 & \cdots & 0 & \xi_{1} \\ \vdots & \ddots & \vdots & \vdots \\ 0 & \cdots & 1 & \xi_{r} \\ 0 & \cdots & 0 & 0 \\ \vdots & \ddots & \vdots & \vdots \\ 0 & \cdots & 0 & 0 \end{pmatrix}
\]
其中 \(c\) 是形式为 \(c = \begin{pmatrix} \xi_{1} \\ \vdots \\ \xi_{r} \\ 0 \\ \vdots \\ 0 \end{pmatrix}\) 的列。这意味着如果在简化齐次系统中求解第 \(i\) 个方程，将第 \(i\) 个基本变量 \(x_{b_{i}}\) 用自由变量 \(x_{f_{i}}, x_{f_{i+1}}, \ldots, x_{f_{n-r}}\) 表示为
\[
x_{b_{i}} = \alpha_{i} x_{f_{i}} + \alpha_{i+1} x_{f_{i+1}} + \cdots + \alpha_{n-r} x_{f_{n-r}}
\]
那么在简化非齐次系统中第 \(i\) 个基本变量的解必须具有形式
\[
x_{b_{i}} = \xi_{i} + \alpha_{i} x_{f_{i}} + \alpha_{i+1} x_{f_{i+1}} + \cdots + \alpha_{n-r} x_{f_{n-r}}
\]
即，两个解仅在于后者包含常数 \(\xi_{i}\)。考虑组织表达式 (2.5.5) 和 (2.5.6) 以构造各自的通解。如果齐次系统的通解具有形式
\[
x = x_{f_{1}} h_{1} + x_{f_{2}} h_{2} + \cdots + x_{f_{n-r}} h_{n-r}
\]
那么显然非齐次系统的通解必须具有类似形式
\[
x = p + x_{f_{1}} h_{1} + x_{f_{2}} h_{2} + \cdots + x_{f_{n-r}} h_{n-r}
\]
其中列 \(p\) 包含常数 \(\xi_{i}\) 以及一些 0——\(\xi_{i}\) 占据 \(p\) 中对应基本列的位置，0 占据所有其他位置。列 \(p\) 表示非齐次系统的一个特解，因为它是当自由变量取 \(x_{f_{1}} = x_{f_{2}} = \cdots = x_{f_{n-r}} = 0\) 时产生的解。

\begin{bluebox}{非齐次系统的通解}
设 \([A \mid b]\) 是一致 \(m \times n\) 非齐次系统的增广矩阵，其中 \(\operatorname{rank}(A) = r\)。将 \([A \mid b]\) 化简为行阶梯形式并求解基本变量用自由变量表示，得到通解
\[
x = p + x_{f_{1}} h_{1} + x_{f_{2}} h_{2} + \cdots + x_{f_{n-r}} h_{n-r}
\]
其中：
- \(p\) 是非齐次系统的一个特解。
- \(x_{f_{1}} h_{1} + x_{f_{2}} h_{2} + \cdots + x_{f_{n-r}} h_{n-r}\) 是关联齐次系统的通解。
- 列 \(p\) 和 \(h_{i}\) 不依赖于 \([A \mid b]\) 化简为何种行阶梯形式。
系统有唯一解当且仅当以下任一条件成立：
- \(\operatorname{rank}(A) = n\)（未知数个数）。
- 没有自由变量。
- 关联齐次系统只有零解。
\end{bluebox}

\textcolor{red}{例子 2.5.1}
\color{red}\rule{\textwidth}{0.4pt}\color{black}

问题：确定以下非齐次系统的通解，并与关联齐次系统的通解比较：
\[
\begin{cases}
x_{1} + 2x_{2} + 3x_{3} + 4x_{4} = 2 \\
2x_{1} + 4x_{2} + 6x_{3} + 7x_{4} = 3 \\
x_{1} + 2x_{2} + 3x_{3} + 5x_{4} = 1
\end{cases}
\]

解答：将增广矩阵 \([A \mid b]\) 化简为 \(E_{[A \mid b]}\)：
\[
\begin{pmatrix}
1 & 2 & 3 & 4 & 2 \\
2 & 4 & 6 & 7 & 3 \\
1 & 2 & 3 & 5 & 1
\end{pmatrix}
\rightarrow
\begin{pmatrix}
1 & 2 & 3 & 4 & 2 \\
0 & 0 & 0 & -1 & -1 \\
0 & 0 & 0 & 1 & -1
\end{pmatrix}
\rightarrow
\begin{pmatrix}
1 & 2 & 3 & 0 & -2 \\
0 & 0 & 0 & 1 & 1 \\
0 & 0 & 0 & 0 & 0
\end{pmatrix}
\]
观察系统确实一致，因为最后一列是非基本的。求解简化系统，将基本变量 \(x_{1}\) 和 \(x_{4}\) 用自由变量 \(x_{2}\) 和 \(x_{3}\) 表示：
\[
x_{4} = 1, \quad x_{1} = -2 - 2x_{2} - 3x_{3}
\]
非齐次系统的通解为：
\[
x = \begin{pmatrix} x_{1} \\ x_{2} \\ x_{3} \\ x_{4} \end{pmatrix} =
\begin{pmatrix} -2 \\ 0 \\ 0 \\ 1 \end{pmatrix} +
x_{2} \begin{pmatrix} -2 \\ 1 \\ 0 \\ 0 \end{pmatrix} +
x_{3} \begin{pmatrix} -3 \\ 0 \\ 1 \\ 0 \end{pmatrix}
\]
关联齐次系统的通解为：
\[
x = x_{2} \begin{pmatrix} -2 \\ 1 \\ 0 \\ 0 \end{pmatrix} +
x_{3} \begin{pmatrix} -3 \\ 0 \\ 1 \\ 0 \end{pmatrix}
\]
验证 \(\begin{pmatrix} -2 \\ 0 \\ 0 \\ 1 \end{pmatrix}\) 是非齐次系统的一个特解，而 \(\begin{pmatrix} -2 \\ 1 \\ 0 \\ 0 \end{pmatrix}\) 和 \(\begin{pmatrix} -3 \\ 0 \\ 1 \\ 0 \end{pmatrix}\) 是关联齐次系统的特解。

\textcolor{red}{例子 2.5.2}
\color{red}\rule{\textwidth}{0.4pt}\color{black}

考虑以下非齐次系统：
\[
\begin{cases}
x_{1} + 2x_{2} + 3x_{3} = 2 \\
2x_{1} + 5x_{2} + 8x_{3} = 5 \\
x_{1} + 3x_{2} + 4x_{3} = 3
\end{cases}
\]
将 \([A \mid b]\) 化简为 \(E_{[A \mid b]}\)：
\[
\begin{pmatrix}
1 & 2 & 3 & 2 \\
2 & 5 & 8 & 5 \\
1 & 3 & 4 & 3
\end{pmatrix}
\rightarrow
\begin{pmatrix}
1 & 2 & 3 & 2 \\
0 & 1 & 2 & 1 \\
0 & 1 & 1 & 1
\end{pmatrix}
\rightarrow
\begin{pmatrix}
1 & 0 & -1 & 0 \\
0 & 1 & 2 & 1 \\
0 & 0 & -1 & 0
\end{pmatrix}
\rightarrow
\begin{pmatrix}
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 1 \\
0 & 0 & 1 & 0
\end{pmatrix}
\]
系统一致，因为最后一列是非基本的。有几种方法看出系统有唯一解。注意 \(\operatorname{rank}(A) = 3 = n\)，这等价于没有自由变量。此外，关联齐次系统显然只有零解。最后，因为我们将 \([A \mid b]\) 完全化简为 \(E_{[A \mid b]}\)，显然只有一个解，由 \(p = \begin{pmatrix} 0 \\ 1 \\ 0 \end{pmatrix}\) 给出。

\begin{enumerate}[leftmargin=*, label=\bfseries 2.5.\arabic*]
\item 确定以下每个非齐次系统的通解。
\begin{enumerate}[label=(\alph*)]
    \item \(
    \begin{cases}
    2x + y + z = 4 \\
    4x + 2y + z = 6 \\
    6x + 3y + z = 8 \\
    8x + 4y + z = 10
    \end{cases}
    \)
    \item \(
    \begin{cases}
    x_{1} + x_{2} + 2x_{3} = 1 \\
    2x_{1} + 2x_{2} + 4x_{3} = 2 \\
    3x_{1} + 3x_{2} + 6x_{3} = 3
    \end{cases}
    \)
    \item \(
    \begin{cases}
    x_{1} + 2x_{2} + x_{3} = 3 \\
    2x_{1} + 4x_{2} + 2x_{3} = 6 \\
    3x_{1} + 6x_{2} + 3x_{3} = 9
    \end{cases}
    \)
\end{enumerate}

\item 在满足线性方程组
\[
\begin{cases}
x + y + z = 1 \\
x - y + z = 2 \\
x + y - z = 3
\end{cases}
\]
的解中，找出所有同时满足以下两个约束的解：
\[
x + y = 2 \quad \text{和} \quad y - z = 0
\]

\item 为了种植某种作物，建议每平方英尺土地施用 10 单位磷、9 单位钾和 19 单位氮。假设市场上有三种肥料品牌，比如品牌 \(\mathcal{X}\)、品牌 \(\mathcal{Y}\) 和品牌 \(\mathcal{Z}\)。一磅品牌 \(\mathcal{X}\) 包含 2 单位磷、3 单位钾和 5 单位氮。一磅品牌 \(\mathcal{Y}\) 包含 1 单位磷、3 单位钾和 4 单位氮。一磅品牌 \(\mathcal{Z}\) 仅包含 1 单位磷和 1 单位氮。
\begin{enumerate}[label=(\alph*)]
    \item 考虑明显事实：任何品牌的施用量不能为负，并且由于肥料的销售方式，每种品牌只能施用整数磅。在这些约束下，确定所有满足推荐量的三种品牌组合。
    \item 假设品牌 \(\mathcal{X}\) 每磅成本 1 美元，品牌 \(\mathcal{Y}\) 每磅成本 6 美元，品牌 \(\mathcal{Z}\) 每磅成本 3 美元。确定满足推荐量且符合 (a) 部分约束的最便宜解决方案。
\end{enumerate}

\item 考虑以下系统：
\[
\begin{cases}
x_{1} + x_{2} + x_{3} = 2 \\
2x_{1} + 3x_{2} + 4x_{3} = 5 \\
3x_{1} + 4x_{2} + \alpha x_{3} = \beta
\end{cases}
\]
\begin{enumerate}[label=(\alph*)]
    \item 确定所有使系统一致的 \(\alpha\) 值。
    \item 确定所有使系统有唯一解的 \(\alpha\) 值，并计算这些情况下的解。
    \item 确定所有使系统有无穷多解的 \(\alpha\) 值，并给出这些情况下的通解。
\end{enumerate}

\item 如果列 \(\mathbf{s}_{1}\) 和 \(\mathbf{s}_{2}\) 是同一非齐次系统的特解，那么和 \(\mathbf{s}_{1} + \mathbf{s}_{2}\) 是否也一定是解？

\item 假设 \([A \mid b]\) 是 \(m\) 个方程 \(n\) 个未知数的一致系统的增广矩阵，其中 \(m \geq n\)。当系统有唯一解时，\(E_{A}\) 必须是什么样子？

\item 构造一个三方程四未知数的非齐次系统，使其通解为
\[
x = \begin{pmatrix} 1 \\ 0 \\ 0 \\ 0 \end{pmatrix} +
x_{3} \begin{pmatrix} -2 \\ 1 \\ 0 \\ 0 \end{pmatrix} +
x_{4} \begin{pmatrix} -3 \\ 0 \\ 1 \\ 0 \end{pmatrix}
\]

\item 考虑使用浮点算术（无部分主元或缩放）求解由以下增广矩阵表示的系统：
\[
\begin{pmatrix}
.835 & .667 & .5 & .168 \\
.333 & .266 & .1994 & .0671 \\
.67 & 1.334 & 1.1 & .436
\end{pmatrix}
\]
\begin{enumerate}[label=(\alph*)]
    \item 确定 4 位数通解。
    \item 确定 5 位数通解。
    \item 确定 6 位数通解。
\end{enumerate}
\end{enumerate}
